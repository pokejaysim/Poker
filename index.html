<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Texas Hold'em Poker - Live Multiplayer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a2e 100%);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .lobby {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
        }

        .lobby h1 {
            font-size: 4rem;
            margin-bottom: 2rem;
            background: linear-gradient(45deg, #f39c12, #e74c3c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(243, 156, 18, 0.5);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { filter: drop-shadow(0 0 20px rgba(243, 156, 18, 0.5)); }
            to { filter: drop-shadow(0 0 30px rgba(231, 76, 60, 0.8)); }
        }

        .lobby-actions {
            display: flex;
            gap: 20px;
            margin-bottom: 2rem;
        }

        .btn {
            padding: 15px 40px;
            font-size: 1.2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(45deg, #e74c3c, #f39c12);
            color: white;
            box-shadow: 0 5px 20px rgba(231, 76, 60, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(231, 76, 60, 0.6);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group input {
            padding: 15px 25px;
            font-size: 1.1rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            width: 300px;
        }

        .input-group input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .input-group input:focus {
            outline: none;
            border-color: #f39c12;
            box-shadow: 0 0 20px rgba(243, 156, 18, 0.3);
        }

        .game-table {
            display: none;
            position: relative;
            background: radial-gradient(ellipse at center, #2d4a2b 0%, #1a2f19 100%);
            border-radius: 200px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8), inset 0 0 100px rgba(0, 0, 0, 0.5);
            margin: 20px auto;
            max-width: 1000px;
            border: 10px solid #3e2723;
        }

        .community-cards {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 40px 0;
            min-height: 120px;
        }

        .card {
            width: 80px;
            height: 110px;
            border-radius: 10px;
            background: linear-gradient(135deg, #fff 0%, #f0f0f0 100%);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            animation: dealCard 0.5s ease-out;
        }

        @keyframes dealCard {
            from {
                transform: translateY(-50px) rotateY(180deg) scale(0.8);
                opacity: 0;
            }
            to {
                transform: translateY(0) rotateY(0) scale(1);
                opacity: 1;
            }
        }

        .card.red { color: #e74c3c; }
        .card.black { color: #2c3e50; }

        .card.back {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: transparent;
        }

        .card.back::before {
            content: 'â™ ';
            position: absolute;
            font-size: 3rem;
            color: rgba(255, 255, 255, 0.1);
            transform: rotate(45deg);
        }

        .players-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
        }

        .player-slot {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            padding: 20px;
            min-width: 200px;
            backdrop-filter: blur(10px);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .player-slot.active {
            border-color: #f39c12;
            box-shadow: 0 0 30px rgba(243, 156, 18, 0.5);
        }

        .player-slot.current-player {
            background: rgba(243, 156, 18, 0.2);
        }

        .player-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #f39c12;
        }

        .player-chips {
            font-size: 1.1rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .chip-icon {
            width: 20px;
            height: 20px;
            background: #f39c12;
            border-radius: 50%;
            display: inline-block;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.3);
        }

        .player-cards {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            min-height: 110px;
        }

        .pot-info {
            text-align: center;
            margin: 30px 0;
            font-size: 1.8rem;
            font-weight: bold;
            color: #f39c12;
            text-shadow: 0 0 20px rgba(243, 156, 18, 0.5);
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 12px 30px;
            font-size: 1rem;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-fold {
            background: #e74c3c;
            color: white;
        }

        .btn-call {
            background: #3498db;
            color: white;
        }

        .btn-raise {
            background: #2ecc71;
            color: white;
        }

        .btn-check {
            background: #95a5a6;
            color: white;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .bet-input {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
            justify-content: center;
        }

        .bet-input input {
            padding: 10px 20px;
            font-size: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            width: 150px;
        }

        .game-status {
            text-align: center;
            font-size: 1.2rem;
            margin: 20px 0;
            color: #ecf0f1;
            min-height: 30px;
        }

        .winner-announcement {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 40px 60px;
            border-radius: 20px;
            text-align: center;
            z-index: 1000;
            animation: winnerPop 0.5s ease-out;
            backdrop-filter: blur(10px);
            border: 3px solid #f39c12;
            box-shadow: 0 0 50px rgba(243, 156, 18, 0.5);
        }

        @keyframes winnerPop {
            from {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
            to {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        .winner-announcement h2 {
            font-size: 3rem;
            color: #f39c12;
            margin-bottom: 20px;
            text-shadow: 0 0 30px rgba(243, 156, 18, 0.8);
        }

        .winner-announcement p {
            font-size: 1.5rem;
            margin-bottom: 30px;
        }

        .room-code {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 1.2rem;
            letter-spacing: 2px;
            margin: 20px 0;
            display: inline-block;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #f39c12;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .lobby h1 {
                font-size: 2.5rem;
            }
            
            .players-container {
                flex-direction: column;
                gap: 20px;
            }
            
            .game-table {
                padding: 20px;
                border-radius: 30px;
            }
            
            .card {
                width: 60px;
                height: 85px;
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="lobby" id="lobby">
            <h1>Texas Hold'em Poker</h1>
            <div class="input-group">
                <input type="text" id="playerName" placeholder="Enter your name" maxlength="20">
            </div>
            <div class="lobby-actions">
                <button class="btn btn-primary" onclick="createGame()">Create Game</button>
                <button class="btn btn-secondary" onclick="showJoinGame()">Join Game</button>
            </div>
            <div id="joinGameSection" style="display: none;">
                <div class="input-group">
                    <input type="text" id="roomCode" placeholder="Enter room code" maxlength="6">
                </div>
                <button class="btn btn-primary" onclick="joinGame()">Join</button>
            </div>
        </div>

        <div class="game-table" id="gameTable">
            <div class="room-code" id="roomCodeDisplay"></div>
            
            <div class="players-container">
                <div class="player-slot" id="player1">
                    <div class="player-name">Waiting for player...</div>
                    <div class="player-chips"></div>
                    <div class="player-cards"></div>
                </div>
                <div class="player-slot" id="player2">
                    <div class="player-name">Waiting for player...</div>
                    <div class="player-chips"></div>
                    <div class="player-cards"></div>
                </div>
            </div>

            <div class="pot-info">Pot: <span class="chip-icon"></span> <span id="potAmount">0</span></div>
            
            <div class="community-cards" id="communityCards"></div>
            
            <div class="game-status" id="gameStatus">Waiting for players...</div>
            
            <div class="action-buttons" id="actionButtons" style="display: none;">
                <button class="action-btn btn-fold" onclick="playerAction('fold')">Fold</button>
                <button class="action-btn btn-check" onclick="playerAction('check')">Check</button>
                <button class="action-btn btn-call" onclick="playerAction('call')">Call</button>
                <button class="action-btn btn-raise" onclick="showRaiseInput()">Raise</button>
            </div>
            
            <div class="bet-input" id="betInput" style="display: none;">
                <input type="number" id="raiseAmount" min="1" placeholder="Amount">
                <button class="action-btn btn-raise" onclick="playerAction('raise')">Confirm Raise</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/10.7.1/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/10.7.1/firebase-firestore-compat.min.js"></script>
    
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDNnyiWr2HIHsvL69LboLoUCIzVmvfanW8",
            authDomain: "poker-7eeef.firebaseapp.com",
            projectId: "poker-7eeef",
            storageBucket: "poker-7eeef.firebasestorage.app",
            messagingSenderId: "203143203913",
            appId: "1:203143203913:web:ea195b6158c16c61280398"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Game state
        let currentGame = null;
        let playerId = null;
        let playerName = null;
        let gameListener = null;

        // Card deck
        const suits = ['â™ ', 'â™¥', 'â™¦', 'â™£'];
        const ranks = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
        const suitColors = { 'â™ ': 'black', 'â™£': 'black', 'â™¥': 'red', 'â™¦': 'red' };

        function generateRoomCode() {
            return Math.random().toString(36).substring(2, 8).toUpperCase();
        }

        function generatePlayerId() {
            return Math.random().toString(36).substring(2, 15);
        }

        function createDeck() {
            const deck = [];
            for (const suit of suits) {
                for (const rank of ranks) {
                    deck.push({ suit, rank });
                }
            }
            return shuffleDeck(deck);
        }

        function shuffleDeck(deck) {
            const newDeck = [...deck];
            for (let i = newDeck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newDeck[i], newDeck[j]] = [newDeck[j], newDeck[i]];
            }
            return newDeck;
        }

        async function createGame() {
            playerName = document.getElementById('playerName').value.trim();
            if (!playerName) {
                alert('Please enter your name');
                return;
            }

            playerId = generatePlayerId();
            const roomCode = generateRoomCode();
            
            const gameData = {
                roomCode,
                players: [{
                    id: playerId,
                    name: playerName,
                    chips: 5000,
                    cards: [],
                    bet: 0,
                    folded: false
                }],
                deck: createDeck(),
                communityCards: [],
                pot: 0,
                currentPlayer: 0,
                stage: 'waiting', // waiting, preflop, flop, turn, river, showdown
                currentBet: 0,
                created: firebase.firestore.FieldValue.serverTimestamp()
            };

            try {
                await db.collection('games').doc(roomCode).set(gameData);
                startGameListener(roomCode);
                showGame(roomCode);
            } catch (error) {
                console.error('Error creating game:', error);
                alert('Error creating game. Please try again.');
            }
        }

        function showJoinGame() {
            document.getElementById('joinGameSection').style.display = 'block';
        }

        async function joinGame() {
            playerName = document.getElementById('playerName').value.trim();
            const roomCode = document.getElementById('roomCode').value.trim().toUpperCase();
            
            if (!playerName) {
                alert('Please enter your name');
                return;
            }
            
            if (!roomCode) {
                alert('Please enter a room code');
                return;
            }

            playerId = generatePlayerId();

            try {
                const gameRef = db.collection('games').doc(roomCode);
                const gameDoc = await gameRef.get();
                
                if (!gameDoc.exists) {
                    alert('Game not found');
                    return;
                }

                const gameData = gameDoc.data();
                
                if (gameData.players.length >= 2) {
                    alert('Game is full');
                    return;
                }

                gameData.players.push({
                    id: playerId,
                    name: playerName,
                    chips: 5000,
                    cards: [],
                    bet: 0,
                    folded: false
                });

                if (gameData.players.length === 2) {
                    gameData.stage = 'preflop';
                    dealCards(gameData);
                }

                await gameRef.update(gameData);
                startGameListener(roomCode);
                showGame(roomCode);
            } catch (error) {
                console.error('Error joining game:', error);
                alert('Error joining game. Please try again.');
            }
        }

        function dealCards(gameData) {
            // Deal 2 cards to each player
            for (let i = 0; i < gameData.players.length; i++) {
                gameData.players[i].cards = [
                    gameData.deck.pop(),
                    gameData.deck.pop()
                ];
            }
        }

        function startGameListener(roomCode) {
            if (gameListener) {
                gameListener();
            }

            gameListener = db.collection('games').doc(roomCode)
                .onSnapshot((doc) => {
                    if (doc.exists) {
                        currentGame = doc.data();
                        currentGame.id = roomCode;
                        updateGameUI();
                    }
                });
        }

        function showGame(roomCode) {
            document.getElementById('lobby').style.display = 'none';
            document.getElementById('gameTable').style.display = 'block';
            document.getElementById('roomCodeDisplay').textContent = `Room: ${roomCode}`;
        }

        function updateGameUI() {
            if (!currentGame) return;

            // Update players
            currentGame.players.forEach((player, index) => {
                const playerSlot = document.getElementById(`player${index + 1}`);
                const isCurrentPlayer = index === currentGame.currentPlayer;
                const isMe = player.id === playerId;
                
                playerSlot.classList.toggle('current-player', isCurrentPlayer && currentGame.stage !== 'waiting');
                playerSlot.classList.toggle('active', isMe);
                
                playerSlot.querySelector('.player-name').textContent = player.name + (isMe ? ' (You)' : '');
                playerSlot.querySelector('.player-chips').innerHTML = `<span class="chip-icon"></span> ${player.chips}`;
                
                const cardsContainer = playerSlot.querySelector('.player-cards');
                cardsContainer.innerHTML = '';
                
                if (player.cards && player.cards.length > 0) {
                    player.cards.forEach(card => {
                        const cardEl = document.createElement('div');
                        cardEl.className = `card ${isMe || currentGame.stage === 'showdown' ? suitColors[card.suit] : 'back'}`;
                        cardEl.textContent = isMe || currentGame.stage === 'showdown' ? `${card.rank}${card.suit}` : '';
                        cardsContainer.appendChild(cardEl);
                    });
                }
            });

            // Update pot
            document.getElementById('potAmount').textContent = currentGame.pot;

            // Update community cards
            const communityContainer = document.getElementById('communityCards');
            communityContainer.innerHTML = '';
            
            currentGame.communityCards.forEach(card => {
                const cardEl = document.createElement('div');
                cardEl.className = `card ${suitColors[card.suit]}`;
                cardEl.textContent = `${card.rank}${card.suit}`;
                communityContainer.appendChild(cardEl);
            });

            // Update game status
            updateGameStatus();

            // Update action buttons
            updateActionButtons();
        }

        function updateGameStatus() {
            const statusEl = document.getElementById('gameStatus');
            
            if (currentGame.stage === 'waiting') {
                statusEl.textContent = 'Waiting for another player...';
            } else if (currentGame.stage === 'showdown') {
                // Will be handled by winner announcement
            } else {
                const currentPlayer = currentGame.players[currentGame.currentPlayer];
                const isMyTurn = currentPlayer.id === playerId;
                statusEl.textContent = isMyTurn ? 'Your turn' : `Waiting for ${currentPlayer.name}...`;
            }
        }

        function updateActionButtons() {
            const actionButtons = document.getElementById('actionButtons');
            const betInput = document.getElementById('betInput');
            
            const currentPlayer = currentGame.players[currentGame.currentPlayer];
            const isMyTurn = currentPlayer && currentPlayer.id === playerId;
            const myPlayer = currentGame.players.find(p => p.id === playerId);
            
            if (isMyTurn && currentGame.stage !== 'waiting' && currentGame.stage !== 'showdown' && !myPlayer.folded) {
                actionButtons.style.display = 'flex';
                
                // Update button states
                const checkBtn = actionButtons.querySelector('.btn-check');
                const callBtn = actionButtons.querySelector('.btn-call');
                
                const callAmount = currentGame.currentBet - myPlayer.bet;
                
                if (callAmount === 0) {
                    checkBtn.style.display = 'block';
                    callBtn.style.display = 'none';
                } else {
                    checkBtn.style.display = 'none';
                    callBtn.style.display = 'block';
                    callBtn.textContent = `Call ${callAmount}`;
                }
            } else {
                actionButtons.style.display = 'none';
                betInput.style.display = 'none';
            }
        }

        function showRaiseInput() {
            document.getElementById('betInput').style.display = 'flex';
            const myPlayer = currentGame.players.find(p => p.id === playerId);
            const minRaise = (currentGame.currentBet - myPlayer.bet) * 2;
            document.getElementById('raiseAmount').min = minRaise;
            document.getElementById('raiseAmount').placeholder = `Min: ${minRaise}`;
        }

        async function playerAction(action) {
            const myPlayer = currentGame.players.find(p => p.id === playerId);
            const gameRef = db.collection('games').doc(currentGame.id);
            
            try {
                const updates = {
                    players: currentGame.players,
                    pot: currentGame.pot,
                    currentBet: currentGame.currentBet,
                    currentPlayer: currentGame.currentPlayer,
                    stage: currentGame.stage,
                    communityCards: currentGame.communityCards,
                    deck: currentGame.deck
                };

                switch (action) {
                    case 'fold':
                        myPlayer.folded = true;
                        break;
                        
                    case 'check':
                        // No action needed
                        break;
                        
                    case 'call':
                        const callAmount = currentGame.currentBet - myPlayer.bet;
                        if (callAmount <= myPlayer.chips) {
                            myPlayer.chips -= callAmount;
                            myPlayer.bet += callAmount;
                            updates.pot += callAmount;
                        }
                        break;
                        
                    case 'raise':
                        const raiseAmount = parseInt(document.getElementById('raiseAmount').value);
                        const totalBet = currentGame.currentBet - myPlayer.bet + raiseAmount;
                        
                        if (totalBet <= myPlayer.chips) {
                            myPlayer.chips -= totalBet;
                            myPlayer.bet += totalBet;
                            updates.pot += totalBet;
                            updates.currentBet = myPlayer.bet;
                        }
                        document.getElementById('betInput').style.display = 'none';
                        break;
                }

                // Check if we need to advance to next stage
                if (shouldAdvanceStage(updates)) {
                    advanceStage(updates);
                } else {
                    // Move to next player
                    updates.currentPlayer = (updates.currentPlayer + 1) % updates.players.length;
                    
                    // Skip folded players
                    while (updates.players[updates.currentPlayer].folded) {
                        updates.currentPlayer = (updates.currentPlayer + 1) % updates.players.length;
                    }
                }

                await gameRef.update(updates);
            } catch (error) {
                console.error('Error performing action:', error);
            }
        }

        function shouldAdvanceStage(gameData) {
            const activePlayers = gameData.players.filter(p => !p.folded);
            
            // If only one player left, they win
            if (activePlayers.length === 1) {
                return true;
            }
            
            // Check if all active players have matched the current bet
            const allMatched = activePlayers.every(p => p.bet === gameData.currentBet);
            
            // Check if we've gone around to all players
            const firstActivePlayer = gameData.players.findIndex(p => !p.folded);
            const completedRound = gameData.currentPlayer === firstActivePlayer && allMatched;
            
            return completedRound || (allMatched && gameData.currentBet > 0);
        }

        function advanceStage(gameData) {
            // Reset bets for new betting round
            gameData.players.forEach(p => p.bet = 0);
            gameData.currentBet = 0;
            gameData.currentPlayer = 0;
            
            switch (gameData.stage) {
                case 'preflop':
                    gameData.stage = 'flop';
                    // Deal 3 community cards
                    for (let i = 0; i < 3; i++) {
                        gameData.communityCards.push(gameData.deck.pop());
                    }
                    break;
                    
                case 'flop':
                    gameData.stage = 'turn';
                    // Deal 1 card
                    gameData.communityCards.push(gameData.deck.pop());
                    break;
                    
                case 'turn':
                    gameData.stage = 'river';
                    // Deal 1 card
                    gameData.communityCards.push(gameData.deck.pop());
                    break;
                    
                case 'river':
                    gameData.stage = 'showdown';
                    determineWinner(gameData);
                    break;
            }
        }

        function determineWinner(gameData) {
            const activePlayers = gameData.players.filter(p => !p.folded);
            
            if (activePlayers.length === 1) {
                // Winner by default
                showWinner(activePlayers[0], gameData.pot);
                resetGame(gameData);
            } else {
                // Evaluate hands
                const playerHands = activePlayers.map(player => ({
                    player,
                    hand: evaluateHand([...player.cards, ...gameData.communityCards])
                }));
                
                // Sort by hand rank
                playerHands.sort((a, b) => compareHands(b.hand, a.hand));
                
                const winner = playerHands[0].player;
                showWinner(winner, gameData.pot, playerHands[0].hand);
                
                // Give pot to winner
                winner.chips += gameData.pot;
                resetGame(gameData);
            }
        }

        function evaluateHand(cards) {
            // This is a simplified hand evaluation
            // In a real game, you'd want a more comprehensive poker hand evaluator
            const ranks = cards.map(c => getRankValue(c.rank));
            const suits = cards.map(c => c.suit);
            
            const rankCounts = {};
            ranks.forEach(rank => {
                rankCounts[rank] = (rankCounts[rank] || 0) + 1;
            });
            
            const counts = Object.values(rankCounts).sort((a, b) => b - a);
            const uniqueRanks = Object.keys(rankCounts).map(Number).sort((a, b) => b - a);
            
            // Check for flush
            const suitCounts = {};
            suits.forEach(suit => {
                suitCounts[suit] = (suitCounts[suit] || 0) + 1;
            });
            const isFlush = Object.values(suitCounts).some(count => count >= 5);
            
            // Check for straight
            const isStraight = checkStraight(uniqueRanks);
            
            // Determine hand rank
            if (isStraight && isFlush) return { rank: 8, name: 'Straight Flush' };
            if (counts[0] === 4) return { rank: 7, name: 'Four of a Kind' };
            if (counts[0] === 3 && counts[1] === 2) return { rank: 6, name: 'Full House' };
            if (isFlush) return { rank: 5, name: 'Flush' };
            if (isStraight) return { rank: 4, name: 'Straight' };
            if (counts[0] === 3) return { rank: 3, name: 'Three of a Kind' };
            if (counts[0] === 2 && counts[1] === 2) return { rank: 2, name: 'Two Pair' };
            if (counts[0] === 2) return { rank: 1, name: 'Pair' };
            
            return { rank: 0, name: 'High Card', highCard: Math.max(...ranks) };
        }

        function getRankValue(rank) {
            const values = { 'J': 11, 'Q': 12, 'K': 13, 'A': 14 };
            return values[rank] || parseInt(rank);
        }

        function checkStraight(ranks) {
            if (ranks.length < 5) return false;
            
            for (let i = 0; i <= ranks.length - 5; i++) {
                let isStraight = true;
                for (let j = 0; j < 4; j++) {
                    if (ranks[i + j] - ranks[i + j + 1] !== 1) {
                        isStraight = false;
                        break;
                    }
                }
                if (isStraight) return true;
            }
            
            // Check for A-2-3-4-5 straight
            if (ranks.includes(14) && ranks.includes(2) && ranks.includes(3) && 
                ranks.includes(4) && ranks.includes(5)) {
                return true;
            }
            
            return false;
        }

        function compareHands(a, b) {
            if (a.rank !== b.rank) return a.rank - b.rank;
            if (a.highCard && b.highCard) return a.highCard - b.highCard;
            return 0;
        }

        function showWinner(winner, pot, hand) {
            const announcement = document.createElement('div');
            announcement.className = 'winner-announcement';
            announcement.innerHTML = `
                <h2>ðŸŽ‰ Winner! ðŸŽ‰</h2>
                <p>${winner.name} wins ${pot} chips!</p>
                ${hand ? `<p>With: ${hand.name}</p>` : ''}
                <button class="btn btn-primary" onclick="closeWinnerAnnouncement()">Continue</button>
            `;
            document.body.appendChild(announcement);
        }

        function closeWinnerAnnouncement() {
            const announcement = document.querySelector('.winner-announcement');
            if (announcement) {
                announcement.remove();
            }
        }

        function resetGame(gameData) {
            // Reset for next hand
            gameData.deck = createDeck();
            gameData.communityCards = [];
            gameData.pot = 0;
            gameData.currentBet = 0;
            gameData.currentPlayer = 0;
            gameData.stage = 'preflop';
            
            gameData.players.forEach(player => {
                player.cards = [];
                player.bet = 0;
                player.folded = false;
            });
            
            dealCards(gameData);
        }
    </script>
</body>
</html>